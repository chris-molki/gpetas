
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Welcome to gpetasâ€™s documentation! &#8212; gpetas 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=e645c8fa"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Define domain" href="notebooks/00_domain_setup.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt="gpetas 0.0.1 documentation - Home"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt="gpetas 0.0.1 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="notebooks/00_domain_setup.html">Define domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/01_getdata_from_file.html">Data from a text file</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/02_getdata_from_online_via_pycsep.html">Data from an online source</a></li>


<li class="toctree-l1"><a class="reference internal" href="notebooks/03_inference_setup.html">Inference setup, model setup</a></li>

<li class="toctree-l1"><a class="reference internal" href="notebooks/04_gibbs_sampling_gpetas.html">Inference: GP-ETAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/04a_classical_inference_MLE_KDE_ETAS.html">Inference: classical ETAS MLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/05_results_summary.html">Results</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="gpetas.html">gpetas package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="gpetas.core.html">gpetas.core package</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpetas.synthetic_experiments.html">gpetas.synthetic_experiments package</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpetas.utils.html">gpetas.utils package</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/chris-molki/gpetas" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/index.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Welcome to gpetasâ€™s documentation!</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Welcome to gpetasâ€™s documentation!</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install">Install</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-virtual-environment">Create virtual environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#package-installation">Package installation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-documentation-locally">Build documentation locally</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-uninstall-gpetas">How to uninstall <code class="docutils literal notranslate"><span class="pre">gpetas</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">Getting started</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#provide-data-and-generate-a-gpetas-data-object">Provide data and generate a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> data object</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-domain">Define domain</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-from-a-text-file">Data from a text file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-from-an-online-source">Data from an online source</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#californian-data">Californian data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inference-setup-model-setup">Inference setup, model setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-object-for-bayesian-inference-gibbs-sampler-gpetas">Setup object for Bayesian inference (Gibbs sampler, gpetas)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-object-for-classical-mle">Setup object for classical MLE</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inference">Inference</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-inference-via-sampling">Bayesian inference via sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-classical-way">Maximum likelihood (classical way)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction">Prediction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#indices-and-tables">Indices and tables</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="welcome-to-gpetas-s-documentation">
<h1>Welcome to gpetasâ€™s documentation!<a class="headerlink" href="#welcome-to-gpetas-s-documentation" title="Link to this heading">#</a></h1>
<section class="tex2jax_ignore mathjax_ignore" id="install">
<h2>Install<a class="headerlink" href="#install" title="Link to this heading">#</a></h2>
<section id="create-virtual-environment">
<h3>Create virtual environment<a class="headerlink" href="#create-virtual-environment" title="Link to this heading">#</a></h3>
<p>Just use the following commands using conda.
It creates virtual environment with python==3.9 installed and activates it</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">gpetas_env</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.9</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">gpetas_env</span>
</pre></div>
</div>
<p>In order to return to the base environment afterwards, use: <em>conda deactivate</em>.</p>
</section>
<section id="package-installation">
<h3>Package installation<a class="headerlink" href="#package-installation" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">chris</span><span class="o">-</span><span class="n">molki</span><span class="o">/</span><span class="n">gpetas</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">gpetas</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements_docs</span><span class="o">.</span><span class="n">txt</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">gpetas</span></code> is installed in developer/editable mode.</p>
</section>
<section id="build-documentation-locally">
<h3>Build documentation locally<a class="headerlink" href="#build-documentation-locally" title="Link to this heading">#</a></h3>
<p>Change into the folder <em>docs</em>
and generate a local documentation in html.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">docs</span>
<span class="n">make</span> <span class="n">html</span>
</pre></div>
</div>
<p>For opening the documentation just open <em>index.html</em> file in a browser, e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">open</span> <span class="o">./</span><span class="n">build</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span>
</pre></div>
</div>
</section>
<section id="how-to-uninstall-gpetas">
<h3>How to uninstall <code class="docutils literal notranslate"><span class="pre">gpetas</span></code><a class="headerlink" href="#how-to-uninstall-gpetas" title="Link to this heading">#</a></h3>
<p>Uninstall or remove <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> and
virtual environment <em>gpetas_env</em> easily
as follows.
Just change to the parent directory
and remove folder <em>gpetas</em>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">..</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="n">gpetas</span>
</pre></div>
</div>
<p>Return to bases environment by deactivating virtual environment <em>gpetas_env</em></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">deactivate</span>
</pre></div>
</div>
<p>Subsequently remove virtual environment <em>gpetas_env</em> using the following
command,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="n">remove</span> <span class="o">-</span><span class="n">n</span> <span class="n">gpetas_env</span>
</pre></div>
</div>
<p>or just delete the directory of <em>gpetas_env</em>.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">#</a></h2>
<p>Then you can already get started:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">gpetas</span></code> is based on following main objects (implemented as python <code class="docutils literal notranslate"><span class="pre">class</span></code>):</p>
<ul class="simple">
<li><p><em><strong>data_obj</strong></em> has all information about the data <span class="math notranslate nohighlight">\(\mathcal{D}=\\{(t_i,\boldsymbol{x}_i,m_i)\\}\_{i=1}\^{N\_{\mathcal{D}}}\)</span> and includes the <em><strong>domain_obj</strong></em></p></li>
<li><p><em><strong>domain_obj</strong></em> has all information about</p>
<ul>
<li><p>temporal domain <span class="math notranslate nohighlight">\(\mathcal{T_{\rm all}}\subset \mathcal{R}\)</span> including absolute time origin, training window <span class="math notranslate nohighlight">\(\mathcal{T}\)</span> and testing
window <span class="math notranslate nohighlight">\(\mathcal{T^\ast}\)</span> with <span class="math notranslate nohighlight">\(\mathcal{T_{\rm all}}=\mathcal{T}\cup\mathcal{T^\ast}\)</span>.</p></li>
<li><p>spatial domain <span class="math notranslate nohighlight">\(\mathcal{X}\subset \mathcal{R}^2\)</span></p></li>
<li><p>domain of the marks (earthquake magnitudes) implemented as <span class="math notranslate nohighlight">\(m\in[m_0,\infty)\)</span></p></li>
</ul>
</li>
<li><p><em><strong>setup_obj</strong></em> has all information required for the inference procedures, e.g., priors
but also the data (stored in <em>data_obj</em>), thus <em>setup_obj</em> includes
<em>data_obj</em> which includes <em>domain_obj</em>: <em>domain_obj</em> <span class="math notranslate nohighlight">\(\subset\)</span> <em>data_obj</em> <span class="math notranslate nohighlight">\(\subset\)</span> <em>setup_obj</em></p></li>
<li><p>inference_obj (as <em><strong>GS_obj</strong></em> or <em><strong>mle_obj</strong></em>) which is used to perform inference
and storing the results. In particular, results of  <em><strong>GS_obj</strong></em>, e.g. samples of the
joint posterior among other things are saved in a <em><strong>save_GS_obj</strong></em> as saving
<em><strong>GS_obj</strong></em> is to heavy. In contrast, <em><strong>mle_obj</strong></em> can be directly saved and reloaded as
it is much lighter in terms of storage.</p></li>
</ul>
<p>For more details find the tutorials below.</p>
<section id="provide-data-and-generate-a-gpetas-data-object">
<h3>Provide data and generate a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> data object<a class="headerlink" href="#provide-data-and-generate-a-gpetas-data-object" title="Link to this heading">#</a></h3>
<p>Provide data and save it as a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> data
object (python class), which is the basis for the inference.</p>
<section id="define-domain">
<h4>Define domain<a class="headerlink" href="#define-domain" title="Link to this heading">#</a></h4>
<p>You have to specify following aspects of
the domain:</p>
<ul class="simple">
<li><p>time domain in days</p>
<ul>
<li><p>time borders for the training <em>T_borders_training</em></p></li>
<li><p>time borders for the testing <em>T_borders_testing</em></p></li>
<li><p>time origin as <em>sting</em> (what corresponds to â€˜0.â€™ days) given by a <em>datetime</em> format: â€˜%Y-%m-%d %H:%M:%S.%fâ€™,
e.g.,â€˜2010-01-01 00:00:00.0â€™</p></li>
</ul>
</li>
<li><p>spatial domain <em>X_borders</em> usually in degrees (Lon,Lat)</p></li>
<li><p>domain of the marks (magnitudes) usually defined through <em>m0</em> as <span class="math notranslate nohighlight">\(m\in[m_0,\infty)\)</span></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># specify domain</span>
<span class="n">time_origin</span> <span class="o">=</span> <span class="s1">&#39;2010-01-01 00:00:00.0&#39;</span>
<span class="n">T_borders_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">4383.</span><span class="p">])</span> <span class="c1"># until &#39;2022-01-01 00:00:00.0&#39;</span>
<span class="n">T_borders_training</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">3000.</span><span class="p">])</span>
<span class="n">X_borders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">120.</span><span class="p">,</span> <span class="o">-</span><span class="mf">113.</span><span class="p">],[</span>  <span class="mf">30.</span><span class="p">,</span>   <span class="mf">37.</span><span class="p">]])</span>
<span class="n">m0</span><span class="o">=</span><span class="mf">3.5</span>

<span class="c1"># save specifications into domain_obj</span>
<span class="n">domain_obj</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">R00x_setup</span><span class="o">.</span><span class="n">region_class</span><span class="p">()</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">T_borders_all</span> <span class="o">=</span> <span class="n">T_borders_all</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">T_borders_training</span><span class="o">=</span><span class="n">T_borders_training</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">T_borders_testing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T_borders_training</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">T_borders_all</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">time_origin</span> <span class="o">=</span> <span class="n">time_origin</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">X_borders</span> <span class="o">=</span> <span class="n">X_borders</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">m0</span> <span class="o">=</span> <span class="n">m0</span>
</pre></div>
</div>
</section>
<section id="data-from-a-text-file">
<h4>Data from a text file<a class="headerlink" href="#data-from-a-text-file" title="Link to this heading">#</a></h4>
<p>Observed data can be provided either directly
in a text file with a specific format which <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> can read.</p>
<ul>
<li><p>a text file with 5 columns, no header, where each row corresponds to a single event (earthquake)</p>
<blockquote>
<div><p>idx, x_lon, y_lat, mag, time</p>
</div></blockquote>
</li>
</ul>
<p>where <em>time</em> is decimal in days. Assuming N observed events, the data file has dimension (N,5), e.g.,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="mi">1</span>   <span class="mf">2.7523</span>  <span class="mf">2.1859</span>  <span class="mf">4.6</span>     <span class="mf">0.000000</span>
    <span class="mi">2</span>   <span class="mf">2.7447</span>  <span class="mf">2.0783</span>  <span class="mf">3.4</span>     <span class="mf">0.004436</span>
    <span class="mi">3</span>   <span class="mf">3.0142</span>  <span class="mf">2.1734</span>  <span class="mf">3.4</span>     <span class="mf">0.320997</span>
    <span class="mi">4</span>   <span class="mf">3.4610</span>  <span class="mf">1.5132</span>  <span class="mf">3.5</span>     <span class="mf">2.271304</span>
    <span class="mi">5</span>   <span class="mf">2.8646</span>  <span class="mf">2.2552</span>  <span class="mf">3.4</span>     <span class="mf">11.108739</span>
    <span class="mi">6</span>   <span class="mf">2.8682</span>  <span class="mf">3.0405</span>  <span class="mf">4.1</span>     <span class="mf">41.841438</span>
    <span class="mi">7</span>   <span class="mf">2.8948</span>  <span class="mf">3.0755</span>  <span class="mf">4.9</span>     <span class="mf">41.963901</span>
    <span class="mi">8</span>   <span class="mf">2.6674</span>  <span class="mf">3.0231</span>  <span class="mf">3.4</span>     <span class="mf">42.026355</span>
</pre></div>
</div>
<p>Generate <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> data class</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
<span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;&lt;path to data file&gt;&#39;</span> <span class="c1"># as a string</span>
<span class="c1"># automatic domain if domain is None</span>
<span class="n">data_obj</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">some_fun</span><span class="o">.</span><span class="n">create_data_obj_from_cat_file</span><span class="p">(</span><span class="n">fname</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span><span class="n">domain_obj</span><span class="o">=</span><span class="n">domain_obj</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">data_obj</span></code> is a python <em>class</em> and contains the data and all information as the data and the considered temporal domain, spatial domain and mark domain.
It is the bases for the inference.
See this <a class="reference internal" href="notebooks/01_getdata_from_file.html"><span class="std std-doc">notebook</span></a></p>
</section>
<section id="data-from-an-online-source">
<h4>Data from an online source<a class="headerlink" href="#data-from-an-online-source" title="Link to this heading">#</a></h4>
<p>Data can be easily downloaded from online sources as</p>
<ul class="simple">
<li><p>USGS: HOST = â€˜<a class="reference external" href="http://earthquake.usgs.gov">earthquake.usgs.gov</a>â€™</p></li>
</ul>
<p>Here we use functionalities provided by the <code class="docutils literal notranslate"><span class="pre">pycsep</span></code> package which
facilitates the data access.
Related functions require a
<em>datetime.datetime</em> object
to specify the start and end times/dates.
<code class="docutils literal notranslate"><span class="pre">pycsep</span></code> provides access to the
ComCat web API and to the
Bollettino Sismico Italiano API using</p>
<ul class="simple">
<li><p>csep.query_comcat()</p></li>
<li><p>csep.query_bsi().</p></li>
</ul>
<p>In <code class="docutils literal notranslate"><span class="pre">pycsep</span></code> data is downloaded and stored into
a <em>catalog object</em> (pyhton class) which
can be easily converted into a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code>
<em>data_obj</em> using <em><strong>data_obj__from_catalog_obj()</strong></em>.</p>
<p>First install <code class="docutils literal notranslate"><span class="pre">pycsep</span></code> using <code class="docutils literal notranslate"><span class="pre">conda</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>gpetas_env
conda<span class="w"> </span>install<span class="w"> </span>--channel<span class="w"> </span>conda-forge<span class="w"> </span>pycsep
</pre></div>
</div>
<p>Start <code class="docutils literal notranslate"><span class="pre">python</span></code> and do the following.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">time_format</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span>


<span class="kn">import</span> <span class="nn">csep</span>
<span class="kn">from</span> <span class="nn">csep.utils</span> <span class="kn">import</span> <span class="n">time_utils</span><span class="p">,</span> <span class="n">comcat</span>
</pre></div>
</div>
<p>Specify the domain of the data to be downloaded and save it to a <em>domain_obj</em> as
described before.</p>
<section id="californian-data">
<h5>Californian data<a class="headerlink" href="#californian-data" title="Link to this heading">#</a></h5>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># time domain</span>
<span class="n">time_origin</span> <span class="o">=</span> <span class="s1">&#39;2010-01-01 00:00:00.0&#39;</span>
<span class="n">time_end</span> <span class="o">=</span> <span class="s1">&#39;2022-01-01 00:00:00.0&#39;</span>
<span class="n">time_origin_obj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_origin</span><span class="p">,</span> <span class="n">time_format</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="n">time_end_obj</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">time_end</span><span class="p">,</span> <span class="n">time_format</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                <span class="n">tzinfo</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
<span class="n">delta_Tall</span><span class="o">=</span><span class="p">(</span><span class="n">time_end_obj</span><span class="o">-</span><span class="n">time_origin_obj</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="mf">60.</span><span class="o">*</span><span class="mf">60.</span><span class="o">*</span><span class="mi">24</span><span class="p">)</span>
<span class="n">T_borders_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="n">delta_Tall</span><span class="p">])</span>
<span class="n">T_borders_training</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mf">3000.</span><span class="p">])</span>

<span class="c1"># spatial domain</span>
<span class="n">X_borders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">120.</span><span class="p">,</span> <span class="o">-</span><span class="mf">113.</span><span class="p">],[</span>  <span class="mf">30.</span><span class="p">,</span>   <span class="mf">37.</span><span class="p">]])</span>

<span class="c1"># mark domain: [m0,+inf)</span>
<span class="n">m0</span><span class="o">=</span><span class="mf">3.5</span>

<span class="n">domain_obj</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">R00x_setup</span><span class="o">.</span><span class="n">region_class</span><span class="p">()</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">T_borders_all</span> <span class="o">=</span> <span class="n">T_borders_all</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">T_borders_training</span><span class="o">=</span><span class="n">T_borders_training</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">T_borders_testing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T_borders_training</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">T_borders_all</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">time_origin</span> <span class="o">=</span> <span class="n">time_origin</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">X_borders</span> <span class="o">=</span> <span class="n">X_borders</span>
<span class="n">domain_obj</span><span class="o">.</span><span class="n">m0</span> <span class="o">=</span> <span class="n">m0</span>
<span class="nb">vars</span><span class="p">(</span><span class="n">domain_obj</span><span class="p">)</span>
</pre></div>
</div>
<p>Based on <em>domain_obj</em> use <code class="docutils literal notranslate"><span class="pre">pycsep</span></code> for
downloading the data into a <em>catalog_obj</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># get pycsep catalog object</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time_origin_obj</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time_end_obj</span>
<span class="n">min_magnitude</span><span class="o">=</span><span class="n">domain_obj</span><span class="o">.</span><span class="n">m0</span>
<span class="n">min_latitude</span><span class="o">=</span><span class="n">domain_obj</span><span class="o">.</span><span class="n">X_borders</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">max_latitude</span><span class="o">=</span><span class="n">domain_obj</span><span class="o">.</span><span class="n">X_borders</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">min_longitude</span><span class="o">=</span><span class="n">domain_obj</span><span class="o">.</span><span class="n">X_borders</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">max_longitude</span><span class="o">=</span><span class="n">domain_obj</span><span class="o">.</span><span class="n">X_borders</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">catalog_obj</span> <span class="o">=</span> <span class="n">csep</span><span class="o">.</span><span class="n">query_comcat</span><span class="p">(</span><span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="n">end_time</span><span class="p">,</span>
                        <span class="n">min_magnitude</span><span class="o">=</span><span class="n">min_magnitude</span><span class="p">,</span>
                        <span class="n">min_latitude</span><span class="o">=</span><span class="n">min_latitude</span><span class="p">,</span><span class="n">max_latitude</span><span class="o">=</span><span class="n">max_latitude</span><span class="p">,</span>
                        <span class="n">min_longitude</span><span class="o">=</span><span class="n">min_longitude</span><span class="p">,</span> <span class="n">max_longitude</span><span class="o">=</span><span class="n">max_longitude</span><span class="p">)</span>
</pre></div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> routine <em>data_obj__from_catalog_obj()</em> to convert
<em>catalog_obj</em> into a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code>
<em>data_obj</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># cat2data_obj</span>
<span class="n">data_obj</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">get_data_pycsep</span><span class="o">.</span><span class="n">data_obj__from_catalog_obj</span><span class="p">(</span><span class="n">catalog_obj</span><span class="o">=</span><span class="n">catalog_obj</span><span class="p">,</span><span class="n">R_obj</span><span class="o">=</span><span class="n">domain_obj</span><span class="p">)</span>
</pre></div>
</div>
<p>Data setup including domain information can
be easily plotted as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="o">=</span><span class="n">gpetas</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">plot_setting</span><span class="p">(</span><span class="n">data_obj</span><span class="o">=</span><span class="n">data_obj</span><span class="p">)</span>
</pre></div>
</div>
<p>See this <a class="reference internal" href="notebooks/02_getdata_from_online_via_pycsep.html"><span class="std std-doc">notebook</span></a></p>
</section>
</section>
</section>
<section id="inference-setup-model-setup">
<h3>Inference setup, model setup<a class="headerlink" href="#inference-setup-model-setup" title="Link to this heading">#</a></h3>
<p>In order to perform inference (Bayesian or Maximum Likelihood estimation,(MLE))
one needs to define or setup several auxiliary variables, which for example
includes priors, number of samples or in the case of MLE stopping rules for
iterative schemes etc.
This is done by creating a <em><strong>setup_obj</strong></em> for the inference which
includes all required information of the</p>
<ul class="simple">
<li><p>Bayesian inference, i.e., Gibbs sampling procedure with Gaussian process
modelling of the background intensity (GP-ETAS, gpetas) or</p></li>
<li><p>classical Maximum Likelihood estimation (MLE) using a kernel density estimator
for the background intensity</p></li>
</ul>
<section id="setup-object-for-bayesian-inference-gibbs-sampler-gpetas">
<h4>Setup object for Bayesian inference (Gibbs sampler, gpetas)<a class="headerlink" href="#setup-object-for-bayesian-inference-gibbs-sampler-gpetas" title="Link to this heading">#</a></h4>
<p>In GP-ETAS (gpetas) we need to define priors on â€¦
In addition, we have to choose control parameters of the Gibbs sampler â€¦
A summary of the setup of GP-ETAS (gpetas) is given in the paper
at page 13.</p>
<p>All this information is contained in the <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> <em>setup_obj</em> which
can be created as follows,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Load or generate <em>data_obj</em> as it is a central part of <em>setup_obj</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### load data_obj</span>
<span class="n">case_name</span> <span class="o">=</span> <span class="s1">&#39;Rxxx&#39;</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;./output/inference_results&#39;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">+</span><span class="s1">&#39;/data_obj_</span><span class="si">%s</span><span class="s1">.all&#39;</span><span class="o">%</span><span class="n">case_name</span>
<span class="n">data_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Set variables for the Bayesian inference.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### variables of the Gibbs sampler</span>

<span class="c1"># sampler parameters</span>
<span class="n">burnin</span> <span class="o">=</span> <span class="mi">50</span>                                <span class="c1"># number of discared initial samples. default: 5000</span>
<span class="n">Ksamples</span> <span class="o">=</span> <span class="mi">10</span>                              <span class="c1"># number of samples of the joint posterior default: 500 (a few hundreds)</span>
<span class="n">thinning</span> <span class="o">=</span> <span class="mi">20</span>                              <span class="c1"># default:10 # or 20:thinning of the obtained samples in order to avoid autocorrelation</span>
<span class="n">num_iterations</span> <span class="o">=</span> <span class="n">Ksamples</span><span class="o">*</span><span class="n">thinning</span><span class="o">+</span><span class="mi">1</span>
<span class="n">MH_proposals_offspring</span> <span class="o">=</span> <span class="mi">100</span>               <span class="c1"># Number of MH proposals for offspring params</span>
<span class="n">MH_cov_empirical_yes</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1"># using empirical cov for proposal distribution</span>
<span class="n">sigma_proposal_offspring_params</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1"># uses default values: 0.01**2 # alternatives:0.03**2</span>
<span class="n">kth_sample_obj</span> <span class="o">=</span> <span class="kc">None</span>                      <span class="c1"># starting sampling from kth sample</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;#iters&#39;</span><span class="p">,</span><span class="n">num_iterations</span><span class="p">)</span>


<span class="c1"># offspring</span>
<span class="n">prior_theta_dist</span> <span class="o">=</span> <span class="s1">&#39;gamma&#39;</span>                 <span class="c1"># specifies prior distribution either &#39;gamma&#39; or &#39;uniform&#39;</span>
<span class="n">prior_theta_params</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">theta_start_Kcpadgq</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1"># uses default values:</span>
<span class="n">spatial_offspring</span> <span class="o">=</span> <span class="s1">&#39;R&#39;</span>                    <span class="c1"># alternatives: &#39;G&#39; gaussian</span>
<span class="n">stable_theta_sampling</span> <span class="o">=</span> <span class="s1">&#39;yes&#39;</span>              <span class="c1"># constraint on theta that only stable Hawkes processes are allowed</span>


<span class="c1"># bg:</span>
<span class="n">cov_params</span> <span class="o">=</span> <span class="kc">None</span>                          <span class="c1"># start values of hypers, uses default: silverman rule</span>
<span class="n">mu_nu0</span> <span class="o">=</span> <span class="kc">None</span>                              <span class="c1"># mean of hyper prior on nu_0, uses default value:</span>



<span class="c1"># bg: spatial resolution for plotting/evaluations</span>
<span class="n">ngrid_per_dim</span> <span class="o">=</span> <span class="mi">50</span>                         <span class="c1"># default value: 50</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">some_fun</span><span class="o">.</span><span class="n">make_X_grid</span><span class="p">(</span><span class="n">data_obj</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">X_borders</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="n">ngrid_per_dim</span><span class="p">)</span>
                                           <span class="c1"># generates spatial grid for plotting etc.</span>

<span class="c1"># general</span>
<span class="n">time_origin</span> <span class="o">=</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">time_origin</span>
<span class="n">case_name</span> <span class="o">=</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">case_name</span>

<span class="c1"># save results</span>
<span class="n">outdir</span> <span class="o">=</span> <span class="n">output_dir</span>
</pre></div>
</div>
<p>Create <em>setup_obj</em> and save it to a directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setup_obj</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">setup_Gibbs_sampler</span><span class="o">.</span><span class="n">setup_sampler</span><span class="p">(</span><span class="n">data_obj</span><span class="o">=</span><span class="n">data_obj</span><span class="p">,</span>
             <span class="n">utm_yes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">spatial_offspring</span><span class="o">=</span><span class="n">spatial_offspring</span><span class="p">,</span>
             <span class="n">theta_start_Kcpadgq</span><span class="o">=</span><span class="n">theta_start_Kcpadgq</span><span class="p">,</span>
             <span class="n">sigma_proposal_offspring_params</span><span class="o">=</span><span class="n">sigma_proposal_offspring_params</span><span class="p">,</span>
             <span class="n">ngrid_per_dim</span><span class="o">=</span><span class="n">ngrid_per_dim</span><span class="p">,</span>
             <span class="n">cov_params</span><span class="o">=</span><span class="n">cov_params</span><span class="p">,</span>
             <span class="n">mu_nu0</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">X_grid</span><span class="o">=</span><span class="n">X_grid</span><span class="p">,</span>
             <span class="n">outdir</span><span class="o">=</span><span class="n">outdir</span><span class="p">,</span>
             <span class="n">prior_theta_dist</span><span class="o">=</span><span class="n">prior_theta_dist</span><span class="p">,</span>
             <span class="n">prior_theta_params</span><span class="o">=</span><span class="n">prior_theta_params</span><span class="p">,</span>
             <span class="n">stable_theta_sampling</span><span class="o">=</span><span class="n">stable_theta_sampling</span><span class="p">,</span>
             <span class="n">time_origin</span><span class="o">=</span><span class="n">time_origin</span><span class="p">,</span>
             <span class="n">case_name</span><span class="o">=</span><span class="n">case_name</span><span class="p">,</span>
             <span class="n">burnin</span><span class="o">=</span><span class="n">burnin</span><span class="p">,</span>
             <span class="n">Ksamples</span><span class="o">=</span><span class="n">Ksamples</span><span class="p">,</span>
             <span class="n">num_iterations</span><span class="o">=</span><span class="n">num_iterations</span><span class="p">,</span>
             <span class="n">thinning</span><span class="o">=</span><span class="n">thinning</span><span class="p">,</span>
             <span class="n">MH_proposals_offspring</span><span class="o">=</span><span class="n">MH_proposals_offspring</span><span class="p">,</span>
             <span class="n">MH_cov_empirical_yes</span><span class="o">=</span><span class="n">MH_cov_empirical_yes</span><span class="p">,</span>
             <span class="n">kth_sample_obj</span><span class="o">=</span><span class="n">kth_sample_obj</span><span class="p">)</span>
</pre></div>
</div>
<p>This object is the bases for the Bayesian inference,
the GP-ETAS Gibbs sampler. It contains <em>data_obj</em>, <em>domain_obj</em> and
all required information in order to perform the inference.
See this <a class="reference internal" href="notebooks/03_inference_setup.html"><span class="std std-doc">notebook</span></a></p>
<p>For the sampling procedure and obtain posterior samples see
section <em>Bayesian inference via sampling</em>.</p>
</section>
<section id="setup-object-for-classical-mle">
<h4>Setup object for classical MLE<a class="headerlink" href="#setup-object-for-classical-mle" title="Link to this heading">#</a></h4>
<p>Similarly to the <em>setup_obj</em> for the Bayesian inference
(GP-ETAS Gibbs sampler) also for MLE of the classical
KDE-ETAS, one has to create first a <em>setup_obj_mle</em> before
the MLE can start.</p>
<p>Similarly, <em>setup_obj_mle</em> contains <em>data_obj</em> and <em>domain_obj</em>.
In addition, several auxiliary variables required for the MLE procedure
have to be defined and are stored in <em>setup_obj_mle</em>.</p>
<p>Load or generate <em>data_obj</em> as it is a central
part of <em>setup_obj_mle</em>.</p>
<p>Here we assume that <em>data_obj</em> was already created and
was saved in â€˜./output/inference_resultsâ€™.</p>
<p>In this example we load a previously generated <em>data_obj</em> and
we also load a previously generated <em>setup_obj</em> of the Gibbs sampler
in order to generate a <em>setup_obj_mle</em> comparable to the Gibbs sampler
setup. We load required objects and we
create <em>setup_obj_mle</em> and save it to a directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">### load data_obj</span>
<span class="n">case_name</span> <span class="o">=</span> <span class="s1">&#39;Rxxx&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">case_name</span><span class="p">)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;./output/inference_results&#39;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">+</span><span class="s1">&#39;/data_obj_</span><span class="si">%s</span><span class="s1">.all&#39;</span><span class="o">%</span><span class="n">case_name</span>
<span class="n">data_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">### load setup_obj from the GP-ETAS sampler</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">+</span><span class="s1">&#39;/setup_obj_</span><span class="si">%s</span><span class="s1">.all&#39;</span><span class="o">%</span><span class="n">case_name</span>
<span class="n">setup_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">### variables of the MLE procedure (EM)</span>

<span class="c1"># bg KDE parameters</span>
<span class="n">Nnearest</span><span class="o">=</span><span class="mi">15</span>                                     <span class="c1"># default value: 15</span>
<span class="n">h_min_degree</span><span class="o">=</span><span class="mf">0.05</span>                               <span class="c1"># default value: 0.05 in degrees</span>
<span class="n">silverman</span> <span class="o">=</span> <span class="kc">None</span>                                <span class="c1"># default value: None #alternative &#39;yes&#39;; minimal bandwith via Silverman Rule yes or no(None)</span>
<span class="n">bins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">X_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  <span class="c1"># default value: 50</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">setup_obj</span><span class="o">.</span><span class="n">X_grid</span>

<span class="c1"># offspring</span>
<span class="n">stable_theta</span> <span class="o">=</span> <span class="n">setup_obj</span><span class="o">.</span><span class="n">stable_theta_sampling</span>
<span class="n">theta_start_Kcpadgqbm0</span> <span class="o">=</span> <span class="n">setup_obj</span><span class="o">.</span><span class="n">theta_start_Kcpadgqbm0</span>  <span class="c1"># uses default values for a stabil Hawkes process:</span>
<span class="n">spatial_offspring</span> <span class="o">=</span> <span class="n">setup_obj</span><span class="o">.</span><span class="n">spatial_offspring</span>

<span class="c1"># save setup_obj_mle</span>
<span class="n">outdir</span> <span class="o">=</span> <span class="n">setup_obj</span><span class="o">.</span><span class="n">outdir</span>
<span class="n">case_name</span> <span class="o">=</span> <span class="n">setup_obj</span><span class="o">.</span><span class="n">case_name</span>

<span class="c1"># create setup_obj_mle</span>
<span class="n">setup_obj_mle</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">mle_KDE_ETAS</span><span class="o">.</span><span class="n">setup_mle</span><span class="p">(</span><span class="n">data_obj</span><span class="o">=</span><span class="n">data_obj</span><span class="p">,</span>
                    <span class="n">theta_start_Kcpadgqbm0</span><span class="o">=</span><span class="n">theta_start_Kcpadgqbm0</span><span class="p">,</span>
                    <span class="n">spatial_offspring</span><span class="o">=</span><span class="n">spatial_offspring</span><span class="p">,</span>
                    <span class="n">Nnearest</span><span class="o">=</span><span class="n">Nnearest</span><span class="p">,</span>
                    <span class="n">h_min_degree</span><span class="o">=</span><span class="n">h_min_degree</span><span class="p">,</span>
                    <span class="n">spatial_units</span><span class="o">=</span><span class="s1">&#39;degree&#39;</span><span class="p">,</span>
                    <span class="n">utm_yes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
                    <span class="n">X_grid</span><span class="o">=</span><span class="n">X_grid</span><span class="p">,</span>
                    <span class="n">outdir</span><span class="o">=</span><span class="n">outdir</span><span class="p">,</span>
                    <span class="n">stable_theta</span><span class="o">=</span><span class="n">stable_theta</span><span class="p">,</span>
                    <span class="n">case_name</span><span class="o">=</span><span class="n">case_name</span><span class="p">,</span>
                    <span class="n">silverman</span><span class="o">=</span><span class="n">silverman</span><span class="p">)</span>
</pre></div>
</div>
<p>See this <a class="reference internal" href="notebooks/03_inference_setup.html"><span class="std std-doc">notebook</span></a></p>
</section>
</section>
<section id="inference">
<h3>Inference<a class="headerlink" href="#inference" title="Link to this heading">#</a></h3>
<section id="bayesian-inference-via-sampling">
<h4>Bayesian inference via sampling<a class="headerlink" href="#bayesian-inference-via-sampling" title="Link to this heading">#</a></h4>
<p>Starting the GP-ETAS sampler requires a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code>
<em>setup_obj</em> as described above. It contains everything
you need: data, domain definition, setup variables.</p>
<p>Load or generate a <em>setup_obj</em> as described above and
initialize the sampler.</p>
<p>In this example we load a previously generated <em>setup_obj</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="n">time_format</span> <span class="o">=</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S.</span><span class="si">%f</span><span class="s2">&quot;</span>

<span class="n">case_name</span> <span class="o">=</span> <span class="s1">&#39;Rxxx&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">case_name</span><span class="p">)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;./output/inference_results&#39;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">+</span><span class="s1">&#39;/setup_obj_</span><span class="si">%s</span><span class="s1">.all&#39;</span><span class="o">%</span><span class="n">case_name</span>
<span class="n">setup_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Subsequently, <code class="docutils literal notranslate"><span class="pre">gpetas</span> <span class="pre">sampler</span></code> can be initialized.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">GS</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">Gibbs_sampler</span><span class="o">.</span><span class="n">GS_ETAS</span><span class="p">(</span><span class="n">data_obj</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">data_obj</span><span class="p">,</span>
        <span class="n">setup_obj</span><span class="o">=</span><span class="n">setup_obj</span><span class="p">,</span>
        <span class="n">burnin</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">burnin</span><span class="p">,</span>
        <span class="n">num_samples</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">Ksamples</span><span class="p">,</span>
        <span class="n">stat_background</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">thinning</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">thinning</span><span class="p">,</span>
        <span class="n">kth_sample_obj</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">kth_sample_obj</span><span class="p">,</span>
        <span class="n">case_name</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">case_name</span><span class="p">,</span>
        <span class="n">MH_proposals_offspring</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">MH_proposals_offspring</span><span class="p">,</span>
        <span class="n">MH_cov_empirical_yes</span><span class="o">=</span><span class="n">setup_obj</span><span class="o">.</span><span class="n">MH_cov_empirical_yes</span><span class="p">)</span>
</pre></div>
</div>
<p>Start sampling</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">GS</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
</pre></div>
</div>
<p>Summary plots of the inference results can
be easily plotted using</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">save_GS_obj</span> <span class="o">=</span> <span class="n">GS</span><span class="o">.</span><span class="n">save_data</span>
<span class="n">gpetas</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">summary_gpetas</span><span class="p">(</span><span class="n">save_GS_obj</span><span class="p">)</span>
</pre></div>
</div>
<p>After <code class="docutils literal notranslate"><span class="pre">getas</span></code> sampler has finished, results of
the inference are saved in an <em><strong>save_GS_obj</strong></em> (python class)
into a file named</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;./output/inference_results/GS_save_data_Rxxx.bin&#39;</span>
</pre></div>
</div>
<p>which can loaded later for post-processing
(statistical analysis, summaries, plotting)
as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fname</span> <span class="o">=</span> <span class="s1">&#39;./output/inference_results/GS_save_data_Rxxx.bin&#39;</span>
<span class="n">save_GS_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="maximum-likelihood-classical-way">
<h4>Maximum likelihood (classical way)<a class="headerlink" href="#maximum-likelihood-classical-way" title="Link to this heading">#</a></h4>
<p>Starting classical MLE requires a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code>
<em>setup_obj_mle</em> as described above. It contains everything
you need: data, domain definition, setup variables.</p>
<p>Load or generate a <em>setup_obj_mle</em> as described above and
start ML inference the sampler.</p>
<p>In this example we load a previously
generated <em>setup_obj_mle</em> and start ML inference</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gpetas</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">case_name</span> <span class="o">=</span> <span class="s1">&#39;Rxxx&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">case_name</span><span class="p">)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;./output/inference_results&#39;</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">+</span><span class="s1">&#39;/setup_obj_default_</span><span class="si">%s</span><span class="s1">_mle.all&#39;</span><span class="o">%</span><span class="n">case_name</span>
<span class="n">setup_obj_mle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Start MLE</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mle_obj</span> <span class="o">=</span> <span class="n">gpetas</span><span class="o">.</span><span class="n">mle_KDE_ETAS</span><span class="o">.</span><span class="n">mle_units</span><span class="p">(</span><span class="n">data_obj</span><span class="o">=</span><span class="n">setup_obj_mle</span><span class="o">.</span><span class="n">data_obj</span><span class="p">,</span> <span class="n">setup_obj</span><span class="o">=</span><span class="n">setup_obj_mle</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="results">
<h3>Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>A summary of the inference results can be obtained
by using <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> summary routine.
Load results <em>save_GS_obj</em> and <em>mle_obj</em> and
<em>mle_obj_silverman</em> and generate summary plots and
tables as follows</p>
<p>You can directly plot a summary of the Bayesian inference or
you can first do MLE and plot subsequently
a summary with comparison</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">case_name</span> <span class="o">=</span> <span class="s1">&#39;Rxxx&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">case_name</span><span class="p">)</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;./output/inference_results&#39;</span>

<span class="c1"># sampler</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">+</span><span class="s1">&#39;/GS_save_data_</span><span class="si">%s</span><span class="s1">.bin&#39;</span><span class="o">%</span><span class="n">case_name</span>
<span class="n">save_GS_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># mle default</span>
<span class="n">fname</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">+</span><span class="s1">&#39;/mle_default_hmin_</span><span class="si">%s</span><span class="s1">.all&#39;</span><span class="o">%</span><span class="n">case_name</span>
<span class="n">mle_obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="prediction">
<h3>Prediction<a class="headerlink" href="#prediction" title="Link to this heading">#</a></h3>
<p>For predictions use <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> routine <em>prediction2D(save_GS_obj,mle_obj,setup_obj_pred)</em>.</p>
</section>
</section>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/00_domain_setup.html">Define domain</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/01_getdata_from_file.html">Data from a text file</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/02_getdata_from_online_via_pycsep.html">Data from an online source</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/02_getdata_from_online_via_pycsep.html#Californian-data">Californian data</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/02_getdata_from_online_via_pycsep.html#Italian-data">Italian data</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/03_inference_setup.html">Inference setup, model setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/03_inference_setup.html#Generating-an-setup_obj-for-GP-ETAS-(gpetas)">Generating an setup_obj for GP-ETAS (gpetas)</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/04_gibbs_sampling_gpetas.html">Inference: GP-ETAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/04a_classical_inference_MLE_KDE_ETAS.html">Inference: classical ETAS MLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/05_results_summary.html">Results</a></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gpetas.html">gpetas package</a></li>
</ul>
</div>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="right-next"
       href="notebooks/00_domain_setup.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Define domain</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Welcome to gpetasâ€™s documentation!</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#install">Install</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-virtual-environment">Create virtual environment</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#package-installation">Package installation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-documentation-locally">Build documentation locally</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-uninstall-gpetas">How to uninstall <code class="docutils literal notranslate"><span class="pre">gpetas</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started">Getting started</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#provide-data-and-generate-a-gpetas-data-object">Provide data and generate a <code class="docutils literal notranslate"><span class="pre">gpetas</span></code> data object</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-domain">Define domain</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-from-a-text-file">Data from a text file</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#data-from-an-online-source">Data from an online source</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#californian-data">Californian data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inference-setup-model-setup">Inference setup, model setup</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-object-for-bayesian-inference-gibbs-sampler-gpetas">Setup object for Bayesian inference (Gibbs sampler, gpetas)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-object-for-classical-mle">Setup object for classical MLE</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inference">Inference</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-inference-via-sampling">Bayesian inference via sampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#maximum-likelihood-classical-way">Maximum likelihood (classical way)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction">Prediction</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By chrism
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023, chrism.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>